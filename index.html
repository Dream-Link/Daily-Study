<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Test Performance Dashboard</title>
    <style>
        /* --- Google Font --- */
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

        /* --- Theme Definitions --- */
        :root, body[data-theme='dark'] {
            --bg-color: #121212; --surface-color: #1e1e1e; --primary-color: #03dac6; --primary-variant: #018786; --text-primary: #ffffff; --text-secondary: #b3b3b3; --header-bg: linear-gradient(145deg, #1e1e1e, #2a2a2a); --shadow-color: rgba(0,0,0,0.5); --rank1-glow: #ffd700; --rank2-glow: #c0c0c0; --rank3-glow: #cd7f32;
        }
        body[data-theme='light'] {
            --bg-color: #f5f5f5; --surface-color: #ffffff; --primary-color: #6200ee; --primary-variant: #3700b3; --text-primary: #000000; --text-secondary: #5f5f5f; --header-bg: linear-gradient(145deg, #ffffff, #f1f3f5); --shadow-color: rgba(0,0,0,0.1); --rank1-glow: #e5b100; --rank2-glow: #8d8d8d; --rank3-glow: #a96628;
        }
        /* Existing Themes */
        body[data-theme='ocean-blue'] { --bg-color: #0d253f; --surface-color: #0d3c61; --primary-color: #01b4e4; --primary-variant: #90cea1; --text-primary: #ffffff; --text-secondary: #c0c0c0; --header-bg: linear-gradient(145deg, #0d3c61, #0c3352); --shadow-color: rgba(0,0,0,0.5); --rank1-glow: #90cea1; --rank2-glow: #c0c0c0; --rank3-glow: #01b4e4; }
        body[data-theme='sunset-glow'] { --bg-color: #2c2541; --surface-color: #4a4063; --primary-color: #ff8c61; --primary-variant: #f45d5d; --text-primary: #f0e6ff; --text-secondary: #d0c2e0; --header-bg: linear-gradient(145deg, #4a4063, #3e3555); --shadow-color: rgba(0,0,0,0.5); --rank1-glow: #ff8c61; --rank2-glow: #f0e6ff; --rank3-glow: #f45d5d; }
        body[data-theme='forest-calm'] { --bg-color: #1e3a36; --surface-color: #2b5049; --primary-color: #6ee3b5; --primary-variant: #43a481; --text-primary: #e8f5e9; --text-secondary: #a5d6a7; --header-bg: linear-gradient(145deg, #2b5049, #23423d); --shadow-color: rgba(0,0,0,0.5); --rank1-glow: #6ee3b5; --rank2-glow: #e8f5e9; --rank3-glow: #a5d6a7; }
        body[data-theme='cyberpunk'] { --bg-color: #0a041c; --surface-color: #1a103c; --primary-color: #f72585; --primary-variant: #7209b7; --text-primary: #ffffff; --text-secondary: #b3aed0; --header-bg: linear-gradient(145deg, #1a103c, #150c31); --shadow-color: rgba(0,0,0,0.5); --rank1-glow: #f72585; --rank2-glow: #7209b7; --rank3-glow: #b3aed0; }
        body[data-theme='midnight'] { --bg-color: #000000; --surface-color: #1a1a1a; --primary-color: #00aaff; --primary-variant: #0077b3; --text-primary: #e6e6e6; --text-secondary: #999999; --header-bg: linear-gradient(145deg, #1a1a1a, #2a2a2a); --shadow-color: rgba(0,0,0,0.6); --rank1-glow: #00aaff; --rank2-glow: #e6e6e6; --rank3-glow: #0077b3; }
        /* --- 20 NEW LIGHT THEMES --- */
        body[data-theme='peach'] { --bg-color: #fff0e6; --surface-color: #ffffff; --primary-color: #ff8a65; --primary-variant: #ff7043; --text-primary: #4e342e; --text-secondary: #795548; --header-bg: linear-gradient(145deg, #ffffff, #fff3ed); --shadow-color: rgba(121, 85, 72, 0.1); --rank1-glow: #ff7043; --rank2-glow: #8d6e63; --rank3-glow: #ffab91; }
        body[data-theme='mint-tulip'] { --bg-color: #f0fdf4; --surface-color: #ffffff; --primary-color: #10b981; --primary-variant: #059669; --text-primary: #1f2937; --text-secondary: #4b5563; --header-bg: linear-gradient(145deg, #ffffff, #f0fdf4); --shadow-color: rgba(31, 41, 55, 0.1); --rank1-glow: #10b981; --rank2-glow: #4b5563; --rank3-glow: #6ee7b7; }
        body[data-theme='lavender'] { --bg-color: #f3e5f5; --surface-color: #ffffff; --primary-color: #ab47bc; --primary-variant: #8e24aa; --text-primary: #212121; --text-secondary: #616161; --header-bg: linear-gradient(145deg, #ffffff, #f3e5f5); --shadow-color: rgba(33, 33, 33, 0.1); --rank1-glow: #ab47bc; --rank2-glow: #616161; --rank3-glow: #ce93d8; }
        body[data-theme='morning-sky'] { --bg-color: #e3f2fd; --surface-color: #ffffff; --primary-color: #42a5f5; --primary-variant: #1e88e5; --text-primary: #0d47a1; --text-secondary: #1565c0; --header-bg: linear-gradient(145deg, #ffffff, #e3f2fd); --shadow-color: rgba(13, 71, 161, 0.1); --rank1-glow: #42a5f5; --rank2-glow: #1565c0; --rank3-glow: #90caf9; }
        body[data-theme='canary'] { --bg-color: #fffde7; --surface-color: #ffffff; --primary-color: #ffd600; --primary-variant: #ffc107; --text-primary: #424242; --text-secondary: #757575; --header-bg: linear-gradient(145deg, #ffffff, #fffde7); --shadow-color: rgba(66, 66, 66, 0.1); --rank1-glow: #ffd600; --rank2-glow: #757575; --rank3-glow: #fff59d; }
        body[data-theme='sandstone'] { --bg-color: #faf3e0; --surface-color: #ffffff; --primary-color: #bfa07a; --primary-variant: #a1887f; --text-primary: #5d4037; --text-secondary: #795548; --header-bg: linear-gradient(145deg, #ffffff, #faf3e0); --shadow-color: rgba(93, 64, 55, 0.1); --rank1-glow: #bfa07a; --rank2-glow: #795548; --rank3-glow: #d7ccc8; }
        body[data-theme='rose-quartz'] { --bg-color: #fce4ec; --surface-color: #ffffff; --primary-color: #ec407a; --primary-variant: #d81b60; --text-primary: #560027; --text-secondary: #880e4f; --header-bg: linear-gradient(145deg, #ffffff, #fce4ec); --shadow-color: rgba(86, 0, 39, 0.1); --rank1-glow: #ec407a; --rank2-glow: #880e4f; --rank3-glow: #f48fb1; }
        body[data-theme='serenity'] { --bg-color: #e8eaf6; --surface-color: #ffffff; --primary-color: #7986cb; --primary-variant: #5c6bc0; --text-primary: #1a237e; --text-secondary: #283593; --header-bg: linear-gradient(145deg, #ffffff, #e8eaf6); --shadow-color: rgba(26, 35, 126, 0.1); --rank1-glow: #7986cb; --rank2-glow: #283593; --rank3-glow: #b39ddb; }
        body[data-theme='gecko'] { --bg-color: #f1f8e9; --surface-color: #ffffff; --primary-color: #9ccc65; --primary-variant: #7cb342; --text-primary: #33691e; --text-secondary: #558b2f; --header-bg: linear-gradient(145deg, #ffffff, #f1f8e9); --shadow-color: rgba(51, 105, 30, 0.1); --rank1-glow: #9ccc65; --rank2-glow: #558b2f; --rank3-glow: #c5e1a5; }
        body[data-theme='cherry-blossom'] { --bg-color: #fff0f5; --surface-color: #ffffff; --primary-color: #ff69b4; --primary-variant: #db7093; --text-primary: #6d2243; --text-secondary: #8b576e; --header-bg: linear-gradient(145deg, #ffffff, #fff0f5); --shadow-color: rgba(109, 34, 67, 0.1); --rank1-glow: #ff69b4; --rank2-glow: #8b576e; --rank3-glow: #ffb6c1; }
        body[data-theme='parchment'] { --bg-color: #fdf6e3; --surface-color: #fffbf2; --primary-color: #b58900; --primary-variant: #856703; --text-primary: #654f00; --text-secondary: #586e75; --header-bg: linear-gradient(145deg, #fffbf2, #fdf6e3); --shadow-color: rgba(101, 79, 0, 0.1); --rank1-glow: #b58900; --rank2-glow: #586e75; --rank3-glow: #d2b48c; }
        body[data-theme='arctic-blue'] { --bg-color: #e0f7fa; --surface-color: #ffffff; --primary-color: #26c6da; --primary-variant: #00acc1; --text-primary: #006064; --text-secondary: #00838f; --header-bg: linear-gradient(145deg, #ffffff, #e0f7fa); --shadow-color: rgba(0, 96, 100, 0.1); --rank1-glow: #26c6da; --rank2-glow: #00838f; --rank3-glow: #80deea; }
        body[data-theme='apricot'] { --bg-color: #fff8e1; --surface-color: #ffffff; --primary-color: #ffb74d; --primary-variant: #ffa726; --text-primary: #e65100; --text-secondary: #f57c00; --header-bg: linear-gradient(145deg, #ffffff, #fff8e1); --shadow-color: rgba(230, 81, 0, 0.1); --rank1-glow: #ffb74d; --rank2-glow: #f57c00; --rank3-glow: #ffcc80; }
        body[data-theme='lilac'] { --bg-color: #ede7f6; --surface-color: #ffffff; --primary-color: #9575cd; --primary-variant: #7e57c2; --text-primary: #311b92; --text-secondary: #4527a0; --header-bg: linear-gradient(145deg, #ffffff, #ede7f6); --shadow-color: rgba(49, 27, 146, 0.1); --rank1-glow: #9575cd; --rank2-glow: #4527a0; --rank3-glow: #d1c4e9; }
        body[data-theme='seafoam'] { --bg-color: #e0f2f1; --surface-color: #ffffff; --primary-color: #4db6ac; --primary-variant: #26a69a; --text-primary: #004d40; --text-secondary: #00695c; --header-bg: linear-gradient(145deg, #ffffff, #e0f2f1); --shadow-color: rgba(0, 77, 64, 0.1); --rank1-glow: #4db6ac; --rank2-glow: #00695c; --rank3-glow: #b2dfdb; }
        body[data-theme='buttercream'] { --bg-color: #fff9c4; --surface-color: #fffde7; --primary-color: #ffee58; --primary-variant: #fdd835; --text-primary: #f57f17; --text-secondary: #f9a825; --header-bg: linear-gradient(145deg, #fffde7, #fff9c4); --shadow-color: rgba(245, 127, 23, 0.1); --rank1-glow: #ffee58; --rank2-glow: #f9a825; --rank3-glow: #fff59d; }
        body[data-theme='terracotta'] { --bg-color: #fbe9e7; --surface-color: #ffffff; --primary-color: #ff8a65; --primary-variant: #f4511e; --text-primary: #bf360c; --text-secondary: #d84315; --header-bg: linear-gradient(145deg, #ffffff, #fbe9e7); --shadow-color: rgba(191, 54, 12, 0.1); --rank1-glow: #ff8a65; --rank2-glow: #d84315; --rank3-glow: #ffccbc; }
        body[data-theme='slate'] { --bg-color: #eceff1; --surface-color: #ffffff; --primary-color: #78909c; --primary-variant: #607d8b; --text-primary: #263238; --text-secondary: #37474f; --header-bg: linear-gradient(145deg, #ffffff, #eceff1); --shadow-color: rgba(38, 50, 56, 0.1); --rank1-glow: #78909c; --rank2-glow: #37474f; --rank3-glow: #b0bec5; }
        body[data-theme='matcha'] { --bg-color: #dcedc8; --surface-color: #f1f8e9; --primary-color: #a5d6a7; --primary-variant: #81c784; --text-primary: #2e7d32; --text-secondary: #388e3c; --header-bg: linear-gradient(145deg, #f1f8e9, #dcedc8); --shadow-color: rgba(46, 125, 50, 0.1); --rank1-glow: #a5d6a7; --rank2-glow: #388e3c; --rank3-glow: #c8e6c9; }
        body[data-theme='coral'] { --bg-color: #fff5f5; --surface-color: #ffffff; --primary-color: #f28b82; --primary-variant: #e15d52; --text-primary: #8c160c; --text-secondary: #b93225; --header-bg: linear-gradient(145deg, #ffffff, #fff5f5); --shadow-color: rgba(140, 22, 12, 0.1); --rank1-glow: #f28b82; --rank2-glow: #b93225; --rank3-glow: #ffcdd2; }
        

        /* --- Basic Styles --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { -webkit-tap-highlight-color: transparent; scroll-behavior: smooth; }
        body { font-family: 'Roboto', sans-serif; background-color: var(--bg-color); color: var(--text-primary); transition: background-color 0.3s ease, color 0.3s ease; }
        .app-container { padding-bottom: 20px; }

        /* --- Improved Header --- */
        .header {
            background: var(--header-bg); padding: 16px 20px; position: sticky; top: 0; z-index: 10;
            box-shadow: 0 4px 12px var(--shadow-color); border-bottom: 1px solid rgba(128, 128, 128, 0.1);
            display: flex; justify-content: space-between; align-items: center;
        }
        .header-title { display: flex; align-items: center; gap: 12px; }
        .header-title svg { width: 28px; height: 28px; fill: var(--text-secondary); }
        .header-info h1 {
            color: var(--text-secondary); font-size: 14px; font-weight: 500; text-transform: uppercase; letter-spacing: 1px;
        }
        .average-score { font-size: 36px; font-weight: 700; color: var(--primary-color); line-height: 1.1; }
        .menu-btn {
            font-size: 28px; cursor: pointer; color: var(--text-secondary); border-radius: 50%; width: 44px; height: 44px;
            display: flex; align-items: center; justify-content: center; transition: background-color 0.2s;
        }
        .menu-btn:hover, .menu-btn:focus { background-color: rgba(128, 128, 128, 0.15); }
        
        /* Dropdown Menu */
        .dropdown-menu {
            display: none; position: absolute; top: 75px; right: 20px; background-color: var(--surface-color);
            border-radius: 8px; box-shadow: 0 8px 30px var(--shadow-color); z-index: 20;
            overflow: hidden; border: 1px solid rgba(128, 128, 128, 0.2);
        }
        .dropdown-menu div { padding: 12px 20px; cursor: pointer; color: var(--text-primary); font-size: 16px; min-width: 180px; }
        .dropdown-menu div:hover { background-color: rgba(128, 128, 128, 0.1); }
        .dropdown-menu div:first-child { border-bottom: 1px solid rgba(128, 128, 128, 0.2); }

        /* --- Result Cards & Animations --- */
        .results-list { padding: 15px; display: grid; gap: 15px; }
        .result-card {
            background-color: var(--surface-color); border-radius: 12px; padding: 20px;
            border-left: 5px solid var(--primary-variant); display: flex; flex-direction: column; gap: 15px;
            transition: transform 0.2s ease-in-out, box-shadow 0.3s ease;
        }
        .card-header .test-name { font-size: 18px; font-weight: 500; color: var(--text-primary); }
        .card-body { display: flex; justify-content: space-around; gap: 15px; }
        .stat { text-align: center; }
        .stat .value { font-size: 24px; font-weight: 700; color: var(--text-primary); }
        .stat .value.marks { color: var(--primary-color); }
        .stat .label { font-size: 14px; color: var(--text-secondary); }

        /* Animations */
        @keyframes rank1-glow {
            0%, 100% { box-shadow: 0 0 12px 0px var(--rank1-glow); }
            50% { box-shadow: 0 0 20px 4px var(--rank1-glow); }
        }
        @keyframes rank2-glow {
            0%, 100% { box-shadow: 0 0 8px 0px var(--rank2-glow); }
            50% { box-shadow: 0 0 14px 2px var(--rank2-glow); }
        }
        @keyframes rank3-glow {
            0%, 100% { box-shadow: 0 0 6px 0px var(--rank3-glow); }
            50% { box-shadow: 0 0 10px 1px var(--rank3-glow); }
        }

        .result-card.top-1 { animation: rank1-glow 3s infinite ease-in-out; }
        .result-card.top-2 { animation: rank2-glow 3.5s infinite ease-in-out; }
        .result-card.top-3 { animation: rank3-glow 4s infinite ease-in-out; }

        /* --- Modals --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7);
            display: none; justify-content: center; align-items: center; z-index: 200; backdrop-filter: blur(5px);
        }
        .modal-content {
            background-color: var(--surface-color); padding: 25px; border-radius: 15px;
            width: 90%; max-width: 400px; box-shadow: 0 5px 20px var(--shadow-color);
        }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-header h2 { font-size: 20px; font-weight: 500; }
        .close-btn { font-size: 28px; font-weight: bold; color: var(--text-secondary); cursor: pointer; border: none; background: none; }
        .form-group { margin-bottom: 20px; }
        .form-group input {
            width: 100%; padding: 12px; background-color: var(--bg-color);
            border: 1px solid var(--text-secondary); border-radius: 8px; color: var(--text-primary); font-size: 16px;
        }
        .modal-btn {
            width: 100%; padding: 12px; border: none; border-radius: 8px; background-color: var(--primary-color);
            color: var(--bg-color); font-size: 16px; font-weight: bold; cursor: pointer;
        }
        #themesGrid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 15px;
            max-height: 60vh; overflow-y: auto; padding-right: 10px;
        }
        .theme-option { cursor: pointer; padding: 10px; border-radius: 8px; text-align: center; border: 2px solid var(--surface-color); transition: border 0.2s ease; }
        .theme-option:hover { border: 2px solid var(--primary-color); }
        .theme-option .theme-name { font-size: 14px; margin-top: 8px; font-weight: 500; }
        .color-palette { display: flex; height: 20px; border-radius: 5px; overflow: hidden; }
    </style>
</head>
<body data-theme="dark">

    <div class="app-container">
        <header class="header">
            <div class="header-title">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,3V21H21V3H3M19,19H5V5H19V19M11,7H13V17H11V7M7,12H9V17H7V12M15,10H17V17H15V10Z" /></svg>
                <div class="header-info">
                    <h1>Performance</h1>
                    <div id="averageScoreDisplay" class="average-score">0.00</div>
                </div>
            </div>
            <div id="menuBtn" class="menu-btn" tabindex="0" role="button" aria-label="Menu">&#8942;</div>
        </header>

        <div id="dropdownMenu" class="dropdown-menu">
            <div id="addTestOption">नया परिणाम जोड़ें</div>
            <div id="changeThemeOption">VIP थीम्स बदलें</div>
        </div>

        <main id="resultsList" class="results-list"></main>
    </div>

    <div id="addTestModal" class="modal-overlay">...</div>
    <div id="themesModal" class="modal-overlay">...</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // Basic setup
    const body = document.body;
    body.querySelector('#addTestModal').innerHTML = `<div class="modal-content"><div class="modal-header"><h2>नया परिणाम जोड़ें</h2><button class="close-btn">&times;</button></div><form id="addTestForm"><div class="form-group"><input type="text" id="testNameInput" placeholder="टेस्ट का नाम" required></div><div class="form-group"><input type="number" step="0.01" id="testMarksInput" placeholder="प्राप्त अंक" required></div><div class="form-group"><input type="text" id="testRankInput" placeholder="रैंक (जैसे 123-4567)" required></div><button type="submit" class="modal-btn">सेव करें</button></form></div>`;
    body.querySelector('#themesModal').innerHTML = `<div class="modal-content"><div class="modal-header"><h2>VIP थीम्स चुनें</h2><button class="close-btn">&times;</button></div><div id="themesGrid"></div></div>`;
    
    // DOM Elements
    const menuBtn = document.getElementById('menuBtn');
    const dropdownMenu = document.getElementById('dropdownMenu');
    const addTestOption = document.getElementById('addTestOption');
    const changeThemeOption = document.getElementById('changeThemeOption');
    const addTestModal = document.getElementById('addTestModal');
    const themesModal = document.getElementById('themesModal');
    const addTestForm = document.getElementById('addTestForm');
    const resultsList = document.getElementById('resultsList');
    const averageScoreDisplay = document.getElementById('averageScoreDisplay');
    const themesGrid = document.getElementById('themesGrid');

    const initialData = [{ name: "00 FLT 00 Result", marks: "116.20", rank: "3426-41639" }, { name: "01 FLT 01 Result", marks: "141.21", rank: "446-16673" }, { name: "01 TESTBOOK 1 Result", marks: "109.12", rank: "4128-29873" }, { name: "02 TESTBOOK 2 Result", marks: "120.15", rank: "1599-18744" }, { name: "03 TESTBOOK 3 Result", marks: "105.78", rank: "2093-13519" }, { name: "04 FLT 04 Result", marks: "124.58", rank: "872-8716" }, { name: "04 TESTBOOK 4 Result", marks: "114.50", rank: "1667-10201" }, { name: "05 FLT 05 Result", marks: "135.70", rank: "423-8553" }, { name: "05 TESTBOOK 5 Result", marks: "121.26", rank: "1373-8232" }, { name: "06 FLT 06 Result", marks: "117.39", rank: "1908-11804" }, { name: "06 TESTBOOK 6 Result", marks: "131.18", rank: "300-5296" }, { name: "07 TESTBOOK 7 Result", marks: "121.08", rank: "499-3677" }];

    // --- Core Functions ---
    const updateAverageScore = () => {
        const allScores = resultsList.querySelectorAll('.score');
        let totalScore = 0;
        allScores.forEach(scoreEl => { totalScore += parseFloat(scoreEl.textContent); });
        averageScoreDisplay.textContent = allScores.length ? (totalScore / allScores.length).toFixed(2) : '0.00';
    };

    const updateTopRankAnimations = () => {
        const cards = Array.from(resultsList.querySelectorAll('.result-card'));
        cards.forEach(c => c.classList.remove('top-1', 'top-2', 'top-3'));

        const scoredCards = cards.map(card => ({
            element: card,
            score: parseFloat(card.querySelector('.score').textContent)
        }));

        scoredCards.sort((a, b) => b.score - a.score);

        if (scoredCards[0]) scoredCards[0].element.classList.add('top-1');
        if (scoredCards[1]) scoredCards[1].element.classList.add('top-2');
        if (scoredCards[2]) scoredCards[2].element.classList.add('top-3');
    };

    const addResultCard = (test, prepend = false) => {
        const card = document.createElement('div');
        card.className = 'result-card';
        card.innerHTML = `<div class="card-header"><span class="test-name">${test.name}</span></div><div class="card-body"><div class="stat"><div class="value marks score">${test.marks}</div><div class="label">अंक</div></div><div class="stat"><div class="value rank">${test.rank}</div><div class="label">रैंक</div></div></div>`;
        if (prepend) resultsList.prepend(card);
        else resultsList.appendChild(card);
    };

    const saveResultsToStorage = () => {
        const cards = resultsList.querySelectorAll('.result-card');
        const results = Array.from(cards).map(card => ({
            name: card.querySelector('.test-name').textContent,
            marks: card.querySelector('.score').textContent,
            rank: card.querySelector('.rank').textContent,
        })).reverse();
        localStorage.setItem('testResults', JSON.stringify(results));
    };

    const loadResultsFromStorage = () => {
        const savedResults = JSON.parse(localStorage.getItem('testResults'));
        resultsList.innerHTML = '';
        const resultsToLoad = savedResults && savedResults.length > 0 ? savedResults : initialData;
        resultsToLoad.forEach(test => addResultCard(test));
        updateAverageScore();
        updateTopRankAnimations();
    };

    // --- Theme Management ---
    const themes = {
        'dark':{name:'डिफ़ॉल्ट डार्क',colors:['#03dac6','#1e1e1e','#b3b3b3']},'light':{name:'सिंपल लाइट',colors:['#6200ee','#ffffff','#5f5f5f']},'ocean-blue':{name:'ओशन ब्लू',colors:['#01b4e4','#0d253f','#90cea1']},'sunset-glow':{name:'सनसेट ग्लो',colors:['#ff8c61','#2c2541','#f45d5d']},'forest-calm':{name:'फॉरेस्ट काम',colors:['#6ee3b5','#1e3a36','#a5d6a7']},'cyberpunk':{name:'साइबरपंक',colors:['#f72585','#0a041c','#7209b7']},'midnight':{name:'मिडनाइट',colors:['#00aaff','#000000','#999999']},'peach':{name:'पीच',colors:['#ff8a65','#fff0e6','#795548']},'mint-tulip':{name:'मिंट ट्यूलिप',colors:['#10b981','#f0fdf4','#4b5563']},'lavender':{name:'लैवेंडर',colors:['#ab47bc','#f3e5f5','#616161']},'morning-sky':{name:'मॉर्निंग स्काई',colors:['#42a5f5','#e3f2fd','#1565c0']},'canary':{name:'कैनरी',colors:['#ffd600','#fffde7','#757575']},'sandstone':{name:'सैंडस्टोन',colors:['#bfa07a','#faf3e0','#795548']},'rose-quartz':{name:'रोज़ क्वार्ट्ज',colors:['#ec407a','#fce4ec','#880e4f']},'serenity':{name:'सेरेनिटी',colors:['#7986cb','#e8eaf6','#283593']},'gecko':{name:'गेको ग्रीन',colors:['#9ccc65','#f1f8e9','#558b2f']},'cherry-blossom':{name:'चेरी ब्लॉसम',colors:['#ff69b4','#fff0f5','#8b576e']},'parchment':{name:'पार्चमेंट',colors:['#b58900','#fdf6e3','#586e75']},'arctic-blue':{name:'आर्कटिक ब्लू',colors:['#26c6da','#e0f7fa','#00838f']},'apricot':{name:'एप्रिकॉट',colors:['#ffb74d','#fff8e1','#f57c00']},'lilac':{name:'लिलैक',colors:['#9575cd','#ede7f6','#4527a0']},'seafoam':{name:'सीफोम',colors:['#4db6ac','#e0f2f1','#00695c']},'buttercream':{name:'बटरक्रीम',colors:['#ffee58','#fff9c4','#f9a825']},'terracotta':{name:'टेराकोटा',colors:['#ff8a65','#fbe9e7','#d84315']},'slate':{name:'स्लेट',colors:['#78909c','#eceff1','#37474f']},'matcha':{name:'माचा',colors:['#a5d6a7','#dcedc8','#388e3c']},'coral':{name:'कोरल',colors:['#f28b82','#fff5f5','#b93225']}
    };
    
    const populateThemes = () => {
        for (const [key, value] of Object.entries(themes)) {
            const option = document.createElement('div');
            option.className = 'theme-option';
            option.dataset.themeName = key;
            option.innerHTML = `<div class="color-palette" style="background: linear-gradient(90deg, ${value.colors[0]} 33%, ${value.colors[1]} 33%, ${value.colors[1]} 66%, ${value.colors[2]} 66%);"></div><div class="theme-name">${value.name}</div>`;
            option.addEventListener('click', () => applyTheme(key, true));
            themesGrid.appendChild(option);
        }
    };

    const applyTheme = (themeName, fromClick = false) => {
        body.dataset.theme = themeName;
        localStorage.setItem('selectedTheme', themeName);
        if(fromClick){
            themesModal.style.display = 'none';
            dropdownMenu.style.display = 'none';
        }
    };
    const loadTheme = () => applyTheme(localStorage.getItem('selectedTheme') || 'dark');

    // --- Event Listeners ---
    menuBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        dropdownMenu.style.display = dropdownMenu.style.display === 'block' ? 'none' : 'block';
    });
    window.addEventListener('click', () => dropdownMenu.style.display = 'none');
    addTestOption.addEventListener('click', () => { addTestModal.style.display = 'flex'; dropdownMenu.style.display = 'none'; });
    changeThemeOption.addEventListener('click', () => { themesModal.style.display = 'flex'; dropdownMenu.style.display = 'none'; });
    [addTestModal, themesModal].forEach(modal => {
        modal.addEventListener('click', (e) => { if (e.target === modal) modal.style.display = 'none'; });
        modal.querySelector('.close-btn').addEventListener('click', () => modal.style.display = 'none');
    });
    
    addTestForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const newTest = {
            name: document.getElementById('testNameInput').value,
            marks: parseFloat(document.getElementById('testMarksInput').value).toFixed(2),
            rank: document.getElementById('testRankInput').value
        };
        addResultCard(newTest, true);
        updateAverageScore();
        saveResultsToStorage();
        updateTopRankAnimations();
        addTestForm.reset();
        addTestModal.style.display = 'none';
    });

    // --- Initial Load ---
    loadTheme();
    populateThemes();
    loadResultsFromStorage();
});
</script>

</body>
</html>